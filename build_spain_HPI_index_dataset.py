# -*- coding: utf-8 -*-
import pandas as pd
import numpy as np
index_reversed = [1475.00, 1481.00, 1468.00, 1462.00, 1450.00, 1468.00, 1446.00, 1446.00,
                  1435.00, 1432.00, 1410.00, 1402.00, 1397.00, 1406.00, 1402.00, 1384.00,
                  1389.00, 1380.00, 1387.49, 1373.00, 1385.00, 1371.00, 1361.00, 1342.00,
                  1343.00, 1348.00, 1358.00, 1322.00, 1340.00, 1348.00, 1339.00, 1345.00,
                  1349.00, 1346.00, 1348.00, 1320.00, 1341.00, 1348.62, 1326.00, 1328.79,
                  1336.40, 1329.00, 1321.85, 1343.57, 1338.00, 1310.00, 1333.00, 1343.00,
                  1316.16, 1337.37, 1332.00, 1340.00, 1363.00, 1378.00, 1371.00, 1367.00,
                  1376.00, 1359.00, 1371.00, 1384.00, 1405.00, 1395.00, 1391.00, 1401.00,
                  1426.00, 1421.00, 1429.00, 1435.00, 1456.00, 1471.00, 1477.00, 1524.00,
                  1514.00, 1525.00, 1532.00, 1545.00, 1577.00, 1589.00, 1595.00, 1603.00,
                  1631.00, 1664.00, 1714.00, 1719.00, 1725.00, 1742.00, 1734.00, 1748.00,
                  1775.00, 1782.00, 1794.00, 1832.00, 1843.00, 1839.00, 1836.00, 1872.00,
                  1875.00, 1871.00, 1872.50, 1874.72, 1897.61, 1907.68, 1905.93, 1916.13,
                  1914.24, 1924.92, 1931.67, 1946.96, 1946.52, 1959.85, 1971.01, 1964.23,
                  1982.71, 1986.54, 1993.33, 2008.76, 2022.18, 2036.95, 2044.23, 2083.94,
                  2083.60, 2116.84, 2149.88, 2155.58, 2184.73, 2209.97, 2210.97, 2233.25,
                  2238.33, 2238.97, 2272.68, 2283.88, 2261.05, 2265.16, 2261.68, 2260.67,
                  2273.73, 2266.14, 2256.93, 2246.58, 2245.55, 2222.65, 2215.95, 2205.30,
                  2193.43, 2170.99, 2160.65, 2123.65, 2118.66, 2095.75, 2073.77, 2047.77,
                  2021.11, 2000.76, 1973.87, 1954.95, 1926.53, 1900.59, 1879.64, 1846.48,
                  1852.67, 1822.23, 1798.63, 1775.65, 1744.04, 1720.14, 1696.84, 1686.79,
                  1659.67, 1634.89, 1621.63, 1598.71, 1595.86, 1570.94, 1556.85, 1530.85,
                  1505.66, 1480.18, 1462.12, 1433.96, 1417.07, 1396.50, 1382.69, 1370.95,
                  1350.99, 1329.29, 1315.41, 1297.16, 1270.34, 1250.39, 1240.72, 1229.40,
                  1216.34, 1192.01, 1180.61, 1167.54, 1159.56, 1154.31, 1137.17, 1117.85,
                  1103.92, 1093.26, 1070.13, 1058.93, 1049.08, 1041.51, 1024.29, 1014.52,
                  1016.89, 1004.22, 985.67, 968.74, 955.51, 946.75, 933.89]
date_reversed = ['Nov. 30, 2018', 'Oct. 31, 2018', 'Sept. 30, 2018', 'Aug. 31, 2018',
                 'July 31, 2018', 'June 30, 2018', 'May 31, 2018', 'April 30, 2018',
                 'March 31, 2018', 'Feb. 28, 2018', 'Jan. 31, 2018', 'Dec. 31, 2017',
                 'Nov. 30, 2017', 'Oct. 31, 2017', 'Sept. 30, 2017', 'Aug. 31, 2017',
                 'July 31, 2017', 'June 30, 2017', 'May 31, 2017', 'April 30, 2017',
                 'March 31, 2017', 'Feb. 28, 2017', 'Jan. 31, 2017', 'Dec. 31, 2016',
                 'Nov. 30, 2016', 'Oct. 31, 2016', 'Sept. 30, 2016', 'Aug. 31, 2016',
                 'July 31, 2016', 'June 30, 2016', 'May 31, 2016', 'April 30, 2016',
                 'March 31, 2016', 'Feb. 29, 2016', 'Jan. 31, 2016', 'Dec. 31, 2015',
                 'Nov. 30, 2015', 'Oct. 31, 2015', 'Sept. 30, 2015', 'Aug. 31, 2015',
                 'July 31, 2015', 'June 30, 2015', 'May 31, 2015', 'April 30, 2015',
                 'March 31, 2015', 'Feb. 28, 2015', 'Jan. 31, 2015', 'Dec. 31, 2014',
                 'Nov. 30, 2014', 'Oct. 31, 2014', 'Sept. 30, 2014', 'Aug. 31, 2014',
                 'July 31, 2014', 'June 30, 2014', 'May 31, 2014', 'April 30, 2014',
                 'March 31, 2014', 'Feb. 28, 2014', 'Jan. 31, 2014', 'Dec. 31, 2013',
                 'Nov. 30, 2013', 'Oct. 31, 2013', 'Sept. 30, 2013', 'Aug. 31, 2013',
                 'July 31, 2013', 'June 30, 2013', 'May 31, 2013', 'April 30, 2013',
                 'March 31, 2013', 'Feb. 28, 2013', 'Jan. 31, 2013', 'Dec. 31, 2012',
                 'Nov. 30, 2012', 'Oct. 31, 2012', 'Sept. 30, 2012', 'Aug. 31, 2012',
                 'July 31, 2012', 'June 30, 2012', 'May 31, 2012', 'April 30, 2012',
                 'March 31, 2012', 'Feb. 29, 2012', 'Jan. 31, 2012', 'Dec. 31, 2011',
                 'Nov. 30, 2011', 'Oct. 31, 2011', 'Sept. 30, 2011', 'Aug. 31, 2011',
                 'July 31, 2011', 'June 30, 2011', 'May 31, 2011', 'April 30, 2011',
                 'March 31, 2011', 'Feb. 28, 2011', 'Jan. 31, 2011', 'Dec. 31, 2010',
                 'Nov. 30, 2010', 'Oct. 31, 2010', 'Sept. 30, 2010', 'Aug. 31, 2010',
                 'July 31, 2010', 'June 30, 2010', 'May 31, 2010', 'April 30, 2010',
                 'March 31, 2010', 'Feb. 28, 2010', 'Jan. 31, 2010', 'Dec. 31, 2009',
                 'Nov. 30, 2009', 'Oct. 31, 2009', 'Sept. 30, 2009', 'Aug. 31, 2009',
                 'July 31, 2009', 'June 30, 2009', 'May 31, 2009', 'April 30, 2009',
                 'March 31, 2009', 'Feb. 28, 2009', 'Jan. 31, 2009', 'Dec. 31, 2008',
                 'Nov. 30, 2008', 'Oct. 31, 2008', 'Sept. 30, 2008', 'Aug. 31, 2008',
                 'July 31, 2008', 'June 30, 2008', 'May 31, 2008', 'April 30, 2008',
                 'March 31, 2008', 'Feb. 29, 2008', 'Jan. 31, 2008', 'Dec. 31, 2007',
                 'Nov. 30, 2007', 'Oct. 31, 2007', 'Sept. 30, 2007', 'Aug. 31, 2007',
                 'July 31, 2007', 'June 30, 2007', 'May 31, 2007', 'April 30, 2007',
                 'March 31, 2007', 'Feb. 28, 2007', 'Jan. 31, 2007', 'Dec. 31, 2006',
                 'Nov. 30, 2006', 'Oct. 31, 2006', 'Sept. 30, 2006', 'Aug. 31, 2006',
                 'July 31, 2006', 'June 30, 2006', 'May 31, 2006', 'April 30, 2006',
                 'March 31, 2006', 'Feb. 28, 2006', 'Jan. 31, 2006', 'Dec. 31, 2005',
                 'Nov. 30, 2005', 'Oct. 31, 2005', 'Sept. 30, 2005', 'Aug. 31, 2005',
                 'July 31, 2005', 'June 30, 2005', 'May 31, 2005', 'April 30, 2005',
                 'March 31, 2005', 'Feb. 28, 2005', 'Jan. 31, 2005', 'Dec. 31, 2004',
                 'Nov. 30, 2004', 'Oct. 31, 2004', 'Sept. 30, 2004', 'Aug. 31, 2004',
                 'July 31, 2004', 'June 30, 2004', 'May 31, 2004', 'April 30, 2004',
                 'March 31, 2004', 'Feb. 29, 2004', 'Jan. 31, 2004', 'Dec. 31, 2003',
                 'Nov. 30, 2003', 'Oct. 31, 2003', 'Sept. 30, 2003', 'Aug. 31, 2003',
                 'July 31, 2003', 'June 30, 2003', 'May 31, 2003', 'April 30, 2003',
                 'March 31, 2003', 'Feb. 28, 2003', 'Jan. 31, 2003', 'Dec. 31, 2002',
                 'Nov. 30, 2002', 'Oct. 31, 2002', 'Sept. 30, 2002', 'Aug. 31, 2002',
                 'July 31, 2002', 'June 30, 2002', 'May 31, 2002', 'April 30, 2002',
                 'March 31, 2002', 'Feb. 28, 2002', 'Jan. 31, 2002', 'Dec. 31, 2001',
                 'Nov. 30, 2001', 'Oct. 31, 2001', 'Sept. 30, 2001', 'Aug. 31, 2001',
                 'July 31, 2001', 'June 30, 2001', 'May 31, 2001', 'April 30, 2001',
                 'March 31, 2001', 'Feb. 28, 2001', 'Jan. 31, 2001']

index_reversed.reverse()
index = index_reversed
date_reversed.reverse()
date = date_reversed
index_nums = len(index)
tp_class = list()
tp_class.append(1)
for i in range(index_nums - 2):
    if index[i + 1] > index[i] and index[i + 1] > index[i + 2]:
        tp_class.append(2)
    elif index[i + 1] < index[i] and index[i + 1] < index[i + 2]:
        tp_class.append(0)
    else:
        tp_class.append(1)
tp_class.append(1)

keyword_real_estate_region_spain_category_all_category_date = ['2004-01', '2004-02', '2004-03', '2004-04',
                                                               '2004-05', '2004-06', '2004-07', '2004-08',
                                                               '2004-09', '2004-10', '2004-11', '2004-12',
                                                               '2005-01', '2005-02', '2005-03', '2005-04',
                                                               '2005-05', '2005-06', '2005-07', '2005-08',
                                                               '2005-09', '2005-10', '2005-11', '2005-12',
                                                               '2006-01', '2006-02', '2006-03', '2006-04',
                                                               '2006-05', '2006-06', '2006-07', '2006-08',
                                                               '2006-09', '2006-10', '2006-11', '2006-12',
                                                               '2007-01', '2007-02', '2007-03', '2007-04',
                                                               '2007-05', '2007-06', '2007-07', '2007-08',
                                                               '2007-09', '2007-10', '2007-11', '2007-12',
                                                               '2008-01', '2008-02', '2008-03', '2008-04',
                                                               '2008-05', '2008-06', '2008-07', '2008-08',
                                                               '2008-09', '2008-10', '2008-11', '2008-12',
                                                               '2009-01', '2009-02', '2009-03', '2009-04',
                                                               '2009-05', '2009-06', '2009-07', '2009-08',
                                                               '2009-09', '2009-10', '2009-11', '2009-12',
                                                               '2010-01', '2010-02', '2010-03', '2010-04',
                                                               '2010-05', '2010-06', '2010-07', '2010-08',
                                                               '2010-09', '2010-10', '2010-11', '2010-12',
                                                               '2011-01', '2011-02', '2011-03', '2011-04',
                                                               '2011-05', '2011-06', '2011-07', '2011-08',
                                                               '2011-09', '2011-10', '2011-11', '2011-12',
                                                               '2012-01', '2012-02', '2012-03', '2012-04',
                                                               '2012-05', '2012-06', '2012-07', '2012-08',
                                                               '2012-09', '2012-10', '2012-11', '2012-12',
                                                               '2013-01', '2013-02', '2013-03', '2013-04',
                                                               '2013-05', '2013-06', '2013-07', '2013-08',
                                                               '2013-09', '2013-10', '2013-11', '2013-12',
                                                               '2014-01', '2014-02', '2014-03', '2014-04',
                                                               '2014-05', '2014-06', '2014-07', '2014-08',
                                                               '2014-09', '2014-10', '2014-11', '2014-12',
                                                               '2015-01', '2015-02', '2015-03', '2015-04',
                                                               '2015-05', '2015-06', '2015-07', '2015-08',
                                                               '2015-09', '2015-10', '2015-11', '2015-12',
                                                               '2016-01', '2016-02', '2016-03', '2016-04',
                                                               '2016-05', '2016-06', '2016-07', '2016-08',
                                                               '2016-09', '2016-10', '2016-11', '2016-12',
                                                               '2017-01', '2017-02', '2017-03', '2017-04',
                                                               '2017-05', '2017-06', '2017-07', '2017-08',
                                                               '2017-09', '2017-10', '2017-11', '2017-12',
                                                               '2018-01', '2018-02', '2018-03', '2018-04',
                                                               '2018-05', '2018-06', '2018-07', '2018-08',
                                                               '2018-09', '2018-10', '2018-11', '2018-12',
                                                               '2019-01']
keyword_real_estate_region_spain_category_all_category_index = [57, 93, 87, 75, 100, 65, 91, 84,
                                                                74, 58, 96, 48, 76, 71, 63, 58,
                                                                67, 64, 50, 73, 54, 49, 53, 46,
                                                                66, 58, 58, 64, 70, 69, 76, 62,
                                                                71, 67, 52, 53, 73, 60, 59, 49,
                                                                58, 52, 61, 56, 56, 61, 44, 28,
                                                                47, 38, 47, 50, 42, 44, 49, 54,
                                                                47, 43, 42, 28, 46, 41, 51, 43,
                                                                89, 49, 51, 52, 59, 46, 60, 40,
                                                                48, 57, 52, 51, 45, 48, 48, 47,
                                                                42, 40, 40, 35, 28, 25, 25, 25,
                                                                25, 29, 27, 32, 26, 29, 26, 25,
                                                                22, 27, 31, 28, 27, 30, 30, 28,
                                                                29, 27, 28, 22, 25, 26, 24, 27,
                                                                28, 32, 31, 32, 31, 33, 29, 28,
                                                                31, 33, 38, 31, 38, 36, 45, 39,
                                                                43, 43, 34, 32, 36, 49, 42, 41,
                                                                41, 39, 43, 37, 42, 37, 37, 31,
                                                                45, 42, 43, 52, 48, 45, 47, 43,
                                                                44, 47, 49, 45, 45, 52, 51, 48,
                                                                49, 46, 45, 40, 50, 49, 48, 34,
                                                                46, 51, 45, 47, 51, 51, 53, 52,
                                                                68, 64, 55, 43, 47]

hpi_log = np.log(index)
moving_avg = pd.rolling_mean(hpi_log, 12)
log_moving_avg_diff = hpi_log - moving_avg
index_temp = index[36:]
date_tmp = keyword_real_estate_region_spain_category_all_category_date[:179]
google_temp = keyword_real_estate_region_spain_category_all_category_index[:179]
tp_temp = tp_class[36:]
print(len(index_temp))
print(len(date_tmp))
print(len(tp_temp))
for i in range(len(date_tmp)):
    print(date_tmp[i], ",", index_temp[i], ",", tp_temp[i])

