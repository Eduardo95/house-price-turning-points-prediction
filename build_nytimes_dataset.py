# -*- coding: utf-8 -*-
import pandas as pd
import numpy as np
'''
这个文件是用来建立和纽约时报数据相关的数据集，包括通过vadarSentiment计算出来的情绪指数和文章数量统计
'''
date = ['1987-01', '1987-02', '1987-03', '1987-04',
        '1987-05', '1987-06', '1987-07', '1987-08',
        '1987-09', '1987-10', '1987-11', '1987-12',
        '1988-01', '1988-02', '1988-03', '1988-04',
        '1988-05', '1988-06', '1988-07', '1988-08',
        '1988-09', '1988-10', '1988-11', '1988-12',
        '1989-01', '1989-02', '1989-03', '1989-04',
        '1989-05', '1989-06', '1989-07', '1989-08',
        '1989-09', '1989-10', '1989-11', '1989-12',
        '1990-01', '1990-02', '1990-03', '1990-04',
        '1990-05', '1990-06', '1990-07', '1990-08',
        '1990-09', '1990-10', '1990-11', '1990-12',
        '1991-01', '1991-02', '1991-03', '1991-04',
        '1991-05', '1991-06', '1991-07', '1991-08',
        '1991-09', '1991-10', '1991-11', '1991-12',
        '1992-01', '1992-02', '1992-03', '1992-04',
        '1992-05', '1992-06', '1992-07', '1992-08',
        '1992-09', '1992-10', '1992-11', '1992-12',
        '1993-01', '1993-02', '1993-03', '1993-04',
        '1993-05', '1993-06', '1993-07', '1993-08',
        '1993-09', '1993-10', '1993-11', '1993-12',
        '1994-01', '1994-02', '1994-03', '1994-04',
        '1994-05', '1994-06', '1994-07', '1994-08',
        '1994-09', '1994-10', '1994-11', '1994-12',
        '1995-01', '1995-02', '1995-03', '1995-04',
        '1995-05', '1995-06', '1995-07', '1995-08',
        '1995-09', '1995-10', '1995-11', '1995-12',
        '1996-01', '1996-02', '1996-03', '1996-04',
        '1996-05', '1996-06', '1996-07', '1996-08',
        '1996-09', '1996-10', '1996-11', '1996-12',
        '1997-01', '1997-02', '1997-03', '1997-04',
        '1997-05', '1997-06', '1997-07', '1997-08',
        '1997-09', '1997-10', '1997-11', '1997-12',
        '1998-01', '1998-02', '1998-03', '1998-04',
        '1998-05', '1998-06', '1998-07', '1998-08',
        '1998-09', '1998-10', '1998-11', '1998-12',
        '1999-01', '1999-02', '1999-03', '1999-04',
        '1999-05', '1999-06', '1999-07', '1999-08',
        '1999-09', '1999-10', '1999-11', '1999-12',
        '2000-01', '2000-02', '2000-03', '2000-04',
        '2000-05', '2000-06', '2000-07', '2000-08',
        '2000-09', '2000-10', '2000-11', '2000-12',
        '2001-01', '2001-02', '2001-03', '2001-04',
        '2001-05', '2001-06', '2001-07', '2001-08',
        '2001-09', '2001-10', '2001-11', '2001-12',
        '2002-01', '2002-02', '2002-03', '2002-04',
        '2002-05', '2002-06', '2002-07', '2002-08',
        '2002-09', '2002-10', '2002-11', '2002-12',
        '2003-01', '2003-02', '2003-03', '2003-04',
        '2003-05', '2003-06', '2003-07', '2003-08',
        '2003-09', '2003-10', '2003-11', '2003-12',
        '2004-01', '2004-02', '2004-03', '2004-04',
        '2004-05', '2004-06', '2004-07', '2004-08',
        '2004-09', '2004-10', '2004-11', '2004-12',
        '2005-01', '2005-02', '2005-03', '2005-04',
        '2005-05', '2005-06', '2005-07', '2005-08',
        '2005-09', '2005-10', '2005-11', '2005-12',
        '2006-01', '2006-02', '2006-03', '2006-04',
        '2006-05', '2006-06', '2006-07', '2006-08',
        '2006-09', '2006-10', '2006-11', '2006-12',
        '2007-01', '2007-02', '2007-03', '2007-04',
        '2007-05', '2007-06', '2007-07', '2007-08',
        '2007-09', '2007-10', '2007-11', '2007-12',
        '2008-01', '2008-02', '2008-03', '2008-04',
        '2008-05', '2008-06', '2008-07', '2008-08',
        '2008-09', '2008-10', '2008-11', '2008-12',
        '2009-01', '2009-02', '2009-03', '2009-04',
        '2009-05', '2009-06', '2009-07', '2009-08',
        '2009-09', '2009-10', '2009-11', '2009-12',
        '2010-01', '2010-02', '2010-03', '2010-04',
        '2010-05', '2010-06', '2010-07', '2010-08',
        '2010-09', '2010-10', '2010-11', '2010-12',
        '2011-01', '2011-02', '2011-03', '2011-04',
        '2011-05', '2011-06', '2011-07', '2011-08',
        '2011-09', '2011-10', '2011-11', '2011-12',
        '2012-01', '2012-02', '2012-03', '2012-04',
        '2012-05', '2012-06', '2012-07', '2012-08',
        '2012-09', '2012-10', '2012-11', '2012-12',
        '2013-01', '2013-02', '2013-03', '2013-04',
        '2013-05', '2013-06', '2013-07', '2013-08',
        '2013-09', '2013-10', '2013-11', '2013-12',
        '2014-01', '2014-02', '2014-03', '2014-04',
        '2014-05', '2014-06', '2014-07', '2014-08',
        '2014-09', '2014-10', '2014-11', '2014-12',
        '2015-01', '2015-02', '2015-03', '2015-04',
        '2015-05', '2015-06', '2015-07', '2015-08',
        '2015-09', '2015-10', '2015-11', '2015-12',
        '2016-01', '2016-02', '2016-03', '2016-04',
        '2016-05', '2016-06', '2016-07', '2016-08',
        '2016-09', '2016-10', '2016-11', '2016-12',
        '2017-01', '2017-02', '2017-03', '2017-04',
        '2017-05', '2017-06', '2017-07', '2017-08',
        '2017-09', '2017-10', '2017-11', '2017-12',
        '2018-01', '2018-02', '2018-03', '2018-04',
        '2018-05', '2018-06', '2018-07']
index = [60.02211021, 50.85651903, 54.58672688, 42.75779579,
         67.66344338, 49.65522672, 43.1480089, 46.27435722,
         46.14182943, 45.46352335, 56.54100624, 48.7761888,
         43.04481471, 46.73847418, 52.43581596, 47.50616449,
         62.86040029, 12.72281206, 56.62585164, 46.51053885,
         49.08885782, 47.19725285, 56.2214, 45.51718101,
         48.11581933, 43.3719184, 44.0963004, 51.55813201,
         54.10385736, 53.32337199, 47.25915668, 43.46465751,
         50.51995411, 52.15073575, 43.20638659, 49.17373806,
         40.15624513, 37.70181121, 37.27532199, 42.20327202,
         41.43825287, 38.90759075, 42.13741014, 26.68106173,
         33.59570224, 26.14140931, 36.99269999, 32.24194183,
         32.33046627, 23.92398882, 34.96562822, 34.78864605,
         32.97034999, 32.83004008, 39.30434627, 35.36204625,
         39.07612263, 32.88059225, 32.76609394, 30.89939574,
         31.79129294, 36.10643754, 35.34717268, 35.83492195,
         41.99727513, 30.23907409, 29.22670375, 36.98397911,
         30.79502437, 34.6833189, 35.933143, 32.95873304,
         41.1357751, 35.54115772, 31.84697493, 38.00930885,
         41.64012321, 28.47074775, 22.81933155, 33.63151023,
         28.14368978, 40.62857774, 33.5443481, 28.89870322,
         35.75974097, 28.23950814, 28.06310686, 34.0031946,
         31.03727272, 27.90578417, 41.63793428, 30.76724552,
         27.57866752, 30.63673268, 28.53020606, 22.36631751,
         29.18150029, 22.52043573, 27.89817999, 36.88260824,
         28.53492355, 48.16850552, 32.91418384, 32.48085849,
         32.26531226, 53.23771781, 34.00708099, 34.13700131,
         37.20696319, 31.98547664, 36.45894278, 25.40636553,
         26.91133458, 36.59837466, 36.97343645, 31.68899414,
         31.4962255, 28.34423618, 31.75864949, 40.7920255,
         41.70213626, 37.3054408, 36.23258744, 38.21684985,
         30.40143525, 62.75301072, 33.39754606, 37.36314344,
         39.07114476, 34.2292511, 45.18976792, 26.40662343,
         39.90354974, 27.6766384, 46.44962578, 38.95037928,
         50.76401106, 32.79756915, 44.13054228, 44.0525334,
         23.96897188, 41.66342057, 46.65254658, 31.72460658,
         39.43072316, 36.28740396, 30.81122545, 38.53507908,
         38.59138525, 53.67974106, 35.22804508, 46.52938302,
         42.07662266, 43.05329506, 34.77061911, 39.68439378,
         43.2542328, 35.32105643, 34.82841086, 45.86038781,
         42.25773986, 36.74019251, 50.21993022, 45.0944847,
         39.97621792, 45.90040945, 45.36590792, 41.05840207,
         41.50669716, 40.92735777, 37.43785319, 32.05534951,
         47.71293518, 41.25028646, 42.80055002, 42.39095389,
         34.56114506, 22.69694787, 28.21850645, 29.95744451,
         27.89979128, 30.54653995, 40.38656211, 35.06734478,
         38.54100443, 38.9127474, 29.87212331, 38.23044185,
         37.6930768, 38.24817122, 33.92956049, 38.16643492,
         40.21711925, 29.30738631, 37.41301549, 40.20350924,
         29.22869864, 42.81233706, 38.19701066, 40.18826577,
         40.79523842, 41.70611383, 44.88637318, 38.03758467,
         45.93233695, 39.04942283, 38.78500786, 40.73412338,
         47.0185544, 46.55520067, 40.74623804, 42.90923994,
         39.64167634, 48.48323654, 49.21910591, 54.0468031,
         56.21275923, 45.28612221, 53.6182063, 43.58241179,
         51.05098099, 53.05266393, 40.32100374, 51.18757292,
         47.16739969, 58.55488366, 35.56613486, 58.79562213,
         57.02358254, 52.01973297, 72.17113007, 52.15891289,
         67.40676937, 80.86134792, 77.75312478, 65.35424273,
         70.32564252, 76.57278162, 60.22865326, 79.27986811,
         52.14384661, 57.98902536, 69.85542957, 77.85423463,
         73.83362659, 64.92699021, 67.8043226, 50.61001024,
         55.65541678, 61.12381138, 51.12748823, 52.52317737,
         48.32680823, 40.1793696, 54.1576884, 52.7544467,
         46.6721112, 57.82736974, 54.97673715, 47.59921424,
         47.14992264, 46.55873526, 55.29112453, 25.44946072,
         37.30478139, 26.91518891, 31.77674483, 46.01998092,
         54.12829902, 43.0915016, 34.45683888, 36.73907053,
         42.4561025, 38.70184654, 43.3242753, 44.47136519,
         41.55804579, 37.0119931, 52.84188203, 54.76747107,
         39.96582647, 55.87435078, 46.67309736, 44.69770858,
         48.29217524, 43.06218998, 38.41802878, 39.31828312,
         48.47785564, 38.97449645, 45.48425253, 44.04667461,
         50.26652365, 46.5655609, 45.44398786, 37.33119158,
         38.33442, 47.38645164, 55.13256303, 62.11393319,
         58.60790807, 48.7969137, 46.03363263, 44.12630425,
         55.50645034, 46.16641131, 41.21635052, 42.68837544,
         51.44025379, 52.79795238, 38.89376641, 31.96225008,
         35.24428168, 47.28395198, 48.18557398, 38.38069209,
         52.78250061, 40.76927677, 33.21063818, 43.08184015,
         43.50920706, 54.70325002, 46.03921707, 31.79810788,
         24.65217537, 35.8022971, 42.03015485, 43.14935177,
         57.61908917, 34.2500313, 38.41611813, 37.43517626,
         33.62891328, 31.88318112, 37.64794916, 36.59284019,
         32.64413234, 34.88569727, 33.55281413, 39.59950855,
         36.72432687, 42.70277225, 36.56677657, 30.88589354,
         33.75132178, 36.30209743, 28.65732702, 37.77413871,
         22.94302069, 21.59416886, 26.98968353, 32.1576047,
         39.58188109, 35.32396847, 30.83875828, 29.858344,
         32.84227479, 36.54844858, 44.92040451, 39.20472916,
         33.39260101, 33.94983206, 38.03635278, 36.95716834,
         38.36150136, 30.84110027, 29.85657802, 31.59277469,
         36.09912038, 35.94260531, 37.87119585, 44.32227029,
         24.23169939, 19.97831958, 37.51136781, 25.48513125,
         30.88529725, 38.65942521, 28.40300287]
nums = [363, 321, 409, 356, 451, 361, 354, 371, 366, 395, 416, 336, 379, 371, 397, 374,
        408, 375, 419, 373, 368, 419, 376, 341, 383, 339, 388, 425, 397, 389, 382, 351,
        375, 389, 389, 409, 424, 342, 368, 466, 396, 380, 391, 347, 377, 404, 396, 400,
        387, 336, 382, 365, 331, 406, 358, 356, 325, 337, 363, 348, 336, 305, 392, 345,
        405, 343, 302, 360, 309, 332, 340, 265, 317, 255, 270, 299, 322, 277, 278, 302,
        238, 309, 240, 234, 292, 233, 283, 256, 237, 237, 296, 263, 231, 256, 244, 205,
        233, 178, 227, 263, 254, 242, 244, 229, 253, 359, 236, 270, 254, 222, 245, 220,
        255, 274, 244, 229, 231, 233, 252, 259, 273, 233, 239, 250, 280, 308, 244, 268,
        291, 253, 318, 241, 264, 208, 305, 276, 315, 250, 271, 313, 283, 282, 320, 218,
        271, 264, 227, 249, 269, 288, 225, 294, 272, 291, 223, 278, 271, 230, 242, 261,
        259, 253, 291, 280, 247, 269, 272, 254, 261, 246, 273, 283, 286, 269, 271, 247,
        304, 265, 254, 261, 218, 220, 281, 252, 266, 299, 243, 274, 298, 286, 267, 282,
        265, 234, 277, 263, 231, 297, 251, 281, 282, 285, 306, 254, 278, 269, 261, 265,
        297, 311, 298, 295, 283, 307, 293, 306, 325, 288, 332, 283, 362, 333, 329, 309,
        299, 339, 326, 399, 383, 395, 468, 446, 455, 557, 501, 460, 505, 551, 492, 498,
        500, 480, 553, 536, 522, 535, 547, 540, 586, 533, 534, 510, 536, 483, 580, 536,
        509, 519, 552, 575, 610, 694, 683, 569, 576, 572, 805, 640, 610, 481, 534, 524,
        565, 588, 544, 579, 609, 530, 570, 666, 647, 545, 541, 625, 571, 658, 460, 423,
        447, 437, 466, 518, 487, 449, 507, 493, 447, 519, 519, 578, 556, 488, 498, 469,
        622, 469, 503, 500, 418, 380, 353, 318, 324, 346, 408, 439, 416, 397, 362, 391,
        366, 404, 349, 382, 369, 326, 368, 402, 398, 359, 352, 341, 316, 350, 324, 323,
        330, 317, 310, 323, 351, 337, 372, 373, 359, 371, 392, 366, 338, 306, 345, 322,
        374, 293, 321, 284, 266, 322, 381, 335, 261, 249, 317, 341, 289, 299, 272, 305,
        305, 316, 327, 322, 251, 220, 308, 280, 325, 287, 262]
ts = pd.DataFrame()
ts.loc[:, 'index'] = [i for i in index]
ts.loc[:, 'nums'] = [i for i in nums]
ts.index = [value for value in date]

ts_original_index = ts['index']
ts_original_log_index = np.log(ts_original_index)
moving_avg_index = pd.rolling_mean(ts_original_log_index, 12)
ts_original_avg_diff_index = ts_original_log_index - moving_avg_index
ts.loc[:, 'log_moving_avg_diff_index'] = [i for i in ts_original_avg_diff_index]

ts_original_nums = ts['nums']
ts_original_log_nums = np.log(ts_original_nums)
moving_avg_nums = pd.rolling_mean(ts_original_log_nums, 12)
ts_original_avg_diff_nums = ts_original_log_nums - moving_avg_nums
ts.loc[:, 'log_moving_avg_diff_nums'] = [i for i in ts_original_avg_diff_nums]

# =======================================================
# 经过处理后的数据格式如下：
#              index  nums  log_moving_avg_diff_index  log_moving_avg_diff_nums
# timestamp1
# timestamp2
# timestamp3
# ......         ......               ......                          ......
# ========================================================

ts.to_pickle('data_directory\\nytimes_data.pkl')
print(ts)
